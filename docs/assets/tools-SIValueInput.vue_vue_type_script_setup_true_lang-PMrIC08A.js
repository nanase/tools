var w=Object.defineProperty;var N=(t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var p=(t,e,n)=>N(t,typeof e!="symbol"?e+"":e,n);import{d as P,l as F,u as k,a as m,w as B,o as M,b,c as C,e as q,f as y,g as v,v as f,V as D}from"./tools-AppBase.vue_vue_type_script_setup_true_lang-CByaW91A.js";const u={symbol:"",exponent:0},x=[{symbol:"Q",exponent:30},{symbol:"R",exponent:27},{symbol:"Y",exponent:24},{symbol:"Z",exponent:21},{symbol:"E",exponent:18},{symbol:"P",exponent:15},{symbol:"T",exponent:12},{symbol:"G",exponent:9},{symbol:"M",exponent:6},{symbol:"k",exponent:3},{symbol:"h",exponent:2},{symbol:"da",exponent:1},u,{symbol:"d",exponent:-1},{symbol:"c",exponent:-2},{symbol:"m",exponent:-3},{symbol:"μ",exponent:-6},{symbol:"u",exponent:-6},{symbol:"n",exponent:-9},{symbol:"p",exponent:-12},{symbol:"f",exponent:-15},{symbol:"a",exponent:-18},{symbol:"z",exponent:-21},{symbol:"y",exponent:-24},{symbol:"r",exponent:-27},{symbol:"q",exponent:-30}],i=class i{constructor(e,n){this.fraction=e,this.prefix=n}get actualValue(){return this.fraction*10**this.prefix.exponent}static getPrefixSymbols(e){return x.filter(n=>n.exponent%(e?1:3)===0).map(n=>n.symbol)}static test(e){return i.siValuePattern.test(e??"")}static parse(e){const n=i.siValuePattern.exec(e??"");if(n==null)return new i(Number.NaN,u);const l=Number.parseFloat(n[1]),o=x.find(a=>a.symbol===n[2]);return o?new i(l,o):new i(l,u)}static fit(e,n){if(!Number.isFinite(e)&&n.length===0)return new i(e,u);if(e!==0){const l=n.map(o=>{const a=i.getPrefix(o),r=e*10**-a.exponent,s=Math.abs(r-500);return{prefix:a,practicalValue:r,rank:s}}).sort((o,a)=>o.rank-a.rank);return new i(l[0].practicalValue,l[0].prefix)}else return new i(0,u)}static fitBy(e,n){if(!Number.isFinite(e))return new i(e,u);const l=i.getPrefix(n),o=e*10**-l.exponent;return new i(o,l)}static getPrefix(e){const n=x.find(l=>l.symbol===e);if(!n)throw new Error(`Prefix symbol '${e}' is not defined.`);return n}static successor(e,n){const l=i.getPrefix(e),o=x.filter(r=>r.exponent>l.exponent&&r.exponent%(n?1:3)===0);if(o.length===0)return e;const a=o.slice(-1)[0];return o.filter(r=>r.exponent===a.exponent)[0].symbol}static predecessor(e,n){const l=i.getPrefix(e),o=x.filter(a=>a.exponent<l.exponent&&a.exponent%(n?1:3)===0);return o.length===0?e:o[0].symbol}};p(i,"siValuePattern",/^([+-]?(?:[0-9]*\.)?[0-9]+)([QRYZEPTGMkmuμnpfazyrq]?)$/);let c=i;const d={required:t=>!!t||"値を入力してください",value:t=>Number.isFinite(c.parse(t).fraction)||"不正な値です",notZero:t=>Number(t)!==0||"値を 0 にはできません",notNegative:t=>{const e=c.parse(t);return Number.isFinite(e.fraction)&&e.fraction>=0||"負値にはできません"}},Z=P({__name:"SIValueInput",props:F({label:null,variant:null,density:null,placeholder:null,unit:null,prefixSymbols:null,readonly:{type:Boolean},disabled:{type:Boolean},fractionDigits:null,rule:null,hideDetails:{type:[Boolean,String]}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(t){const e=k(t,"value"),n=m(),l=m();B(()=>e.value,()=>{o()}),M(()=>{o()});function o(){var r;if(typeof e.value<"u"&&Number.isFinite(e.value)&&!((r=l.value)!=null&&r.focused)){const s=c.fit(e.value,t.prefixSymbols??[""]);n.value=`${s.fraction.toFixed(t.fractionDigits??3)}${s.prefix.symbol}`}}function a(r){const s=c.parse(r);Number.isFinite(s.fraction)&&(e.value=s.actualValue)}return(r,s)=>{const h=b("v-col"),g=b("v-row");return C(),q(g,{"no-gutters":""},{default:y(()=>[v(h,null,{default:y(()=>[v(f(D),{"model-value":n.value,"onUpdate:modelValue":[s[0]||(s[0]=V=>n.value=V),a],label:t.label,variant:t.variant,density:t.density,placeholder:t.placeholder,rules:t.readonly?[]:t.rule?t.rule:[f(d).required,f(d).value,f(d).notZero,f(d).notNegative],readonly:t.readonly,disabled:t.disabled,prefix:t.unit,class:"text-align-right",reverse:"",inputmode:"numeric",ref_key:"field",ref:l,"hide-details":t.hideDetails},null,8,["model-value","label","variant","density","placeholder","rules","readonly","disabled","prefix","hide-details"])]),_:1})]),_:1})}}});export{d as R,Z as _};
