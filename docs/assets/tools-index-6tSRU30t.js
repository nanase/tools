import{t as v,n as h,i as k,a as d}from"./tools-index-CwfruueO.js";import{m as p,k as y,j as m,z as O,n as W,a3 as S}from"./tools-ToolAppBase.vue_vue_type_script_setup_true_lang-BJ6W5dVp.js";function R(t){var n;const o=v(t);return(n=o==null?void 0:o.$el)!=null?n:o}const w=k?window:void 0;function z(){const t=m(!1),n=O();return n&&W(()=>{t.value=!0},n),t}function A(t){const n=z();return p(()=>(n.value,!!t()))}function j(t,n,o={}){const{window:a=w,...r}=o;let e;const i=A(()=>a&&"MutationObserver"in a),l=()=>{e&&(e.disconnect(),e=void 0)},s=p(()=>{const u=v(t),c=(Array.isArray(u)?u:[u]).map(R).filter(h);return new Set(c)}),M=y(()=>s.value,u=>{l(),i.value&&u.size&&(e=new MutationObserver(n),u.forEach(c=>e.observe(c,r)))},{immediate:!0,flush:"post"}),b=()=>e==null?void 0:e.takeRecords(),f=()=>{M(),l()};return d(f),{isSupported:i,stop:f,takeRecords:b}}function x(t,n,o){const{window:a=w}={},r=m(null),e=S(),i=(...s)=>{e.value&&e.value.postMessage(...s)},l=function(){e.value&&e.value.terminate()};return a&&(typeof t=="string"?e.value=new Worker(t,n):typeof t=="function"?e.value=t():e.value=t,e.value.onmessage=s=>{r.value=s.data},d(()=>{e.value&&e.value.terminate()})),{data:r,post:i,terminate:l,worker:e}}export{j as a,x as u};
