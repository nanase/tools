var In=Object.defineProperty;var Tn=(t,e,n)=>e in t?In(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var X=(t,e,n)=>Tn(t,typeof e!="symbol"?e+"":e,n);import{d as Dn,a1 as qn,j as C,m as Mt,k as pe,r as B,o as Re,c as Ie,w as y,a as c,h as m,f as M,u as A,W as On,G as zn,t as R,_ as jn,a2 as Fn,i as En}from"../tools-ToolAppBase.vue_vue_type_script_setup_true_lang-BJ6W5dVp.js";import{u as Bn}from"../tools-index-6tSRU30t.js";import{y as Te,i as Vn}from"../tools-object-BaSs9UKu.js";import{o as I}from"../tools-SIValueInput.vue_vue_type_script_setup_true_lang-CvgRkyND.js";import{d as Wn,C as ae,i as xe,a as ee,c as Ln,u as Nn,b as re,e as at,f as Jt,g as N,v as we,E as ue,t as H,h as We,j as rt,k as Hn,P as E,A as Yn,l as Ee,m as $n,n as Xn,Q as be,H as De,T as Ct,o as Qn,p as kt,R as Kt,_ as St}from"../tools-ChartBase.vue_vue_type_script_setup_true_lang-CYp05Y4s.js";import{S as _t,o as Zt,a as en,T as Un,b as Ue,c as Pt,P as qe,_ as Ge,s as Gn,M as Jn}from"../tools-SignalIndicator.vue_vue_type_style_index_0_lang-BkyCRujO.js";import{_ as P}from"../tools-MathJax.vue_vue_type_style_index_0_lang-CKHDXnHE.js";import{_ as se}from"../tools-InputRow.vue_vue_type_script_setup_true_lang-RnAkmi3n.js";import{u as Kn}from"../tools-index-CwfruueO.js";import{_ as Zn}from"../tools-_plugin-vue_export-helper-DlAUqK2U.js";function At(t,e){if(typeof e>"u"){const n=Array(t);let o=0;for(;o<t;)n[o]=o++;return n}else{const n=Array(e-t);let o=0,s=t;for(;s<e;)n[o++]=s++;return n}}function eo(t,e){const n=Array(e);let o=0;for(;o<e;)n[o]=t/e*o++;return n}function Rt(t){let e=-1/0,n=1/0,o=-1,s=-1,a=0;for(const i of t)i>e&&(e=i,o=a),i<n&&(n=i,s=a),a++;return{max:e,min:n,maxIndex:o,minIndex:s}}function Be(t,e){const n=t.length;if(n!=e.length)throw new RangeError("Mismatched lengths");n!=0&&(n&n-1?oo(t,e):no(t,e))}function to(t,e){Be(e,t)}function no(t,e){const n=t.length;if(n!=e.length)throw new RangeError("Mismatched lengths");if(n==1)return;let o=-1;for(let r=0;r<32;r++)1<<r==n&&(o=r);if(o==-1)throw new RangeError("Length is not a power of 2");const s=new Array(n/2),a=new Array(n/2);for(let r=0;r<n/2;r++)s[r]=Math.cos(2*Math.PI*r/n),a[r]=Math.sin(2*Math.PI*r/n);for(let r=0;r<n;r++){const l=i(r,o);if(l>r){let u=t[r];t[r]=t[l],t[l]=u,u=e[r],e[r]=e[l],e[l]=u}}for(let r=2;r<=n;r*=2){const l=r/2,u=n/r;for(let h=0;h<n;h+=r)for(let g=h,f=0;g<h+l;g++,f+=u){const b=g+l,x=t[b]*s[f]+e[b]*a[f],T=-t[b]*a[f]+e[b]*s[f];t[b]=t[g]-x,e[b]=e[g]-T,t[g]+=x,e[g]+=T}}function i(r,l){let u=0;for(let h=0;h<l;h++)u=u<<1|r&1,r>>>=1;return u}}function oo(t,e){const n=t.length;if(n!=e.length)throw new RangeError("Mismatched lengths");let o=1;for(;o<n*2+1;)o*=2;const s=new Array(n),a=new Array(n);for(let f=0;f<n;f++){const b=f*f%(n*2);s[f]=Math.cos(Math.PI*b/n),a[f]=Math.sin(Math.PI*b/n)}const i=Oe(o),r=Oe(o);for(let f=0;f<n;f++)i[f]=t[f]*s[f]+e[f]*a[f],r[f]=-t[f]*a[f]+e[f]*s[f];const l=Oe(o),u=Oe(o);l[0]=s[0],u[0]=a[0];for(let f=1;f<n;f++)l[f]=l[o-f]=s[f],u[f]=u[o-f]=a[f];const h=new Array(o),g=new Array(o);so(i,r,l,u,h,g);for(let f=0;f<n;f++)t[f]=h[f]*s[f]+g[f]*a[f],e[f]=-h[f]*a[f]+g[f]*s[f]}function so(t,e,n,o,s,a){const i=t.length;if(i!=e.length||i!=n.length||i!=o.length||i!=s.length||i!=a.length)throw new RangeError("Mismatched lengths");t=t.slice(),e=e.slice(),n=n.slice(),o=o.slice(),Be(t,e),Be(n,o);for(let r=0;r<i;r++){const l=t[r]*n[r]-e[r]*o[r];e[r]=e[r]*n[r]+t[r]*o[r],t[r]=l}to(t,e);for(let r=0;r<i;r++)s[r]=t[r]/i,a[r]=e[r]/i}function Oe(t){const e=[];for(let n=0;n<t;n++)e.push(0);return e}let io=class j{constructor(e){X(this,"_coefficients",new Float64Array(6));X(this,"_normalizedCoefficients",new Float64Array(5));X(this,"_impluseResponse");X(this,"_real");X(this,"_imag");X(this,"_phaseResponse");X(this,"_frequencyResponse");this.impulseLength=e,this._impluseResponse=new Float64Array(this.impulseLength),this._real=new Float64Array(this.impulseLength),this._imag=new Float64Array(this.impulseLength),this._phaseResponse=new Float64Array(this.impulseLength/2),this._frequencyResponse=new Float64Array(this.impulseLength/2)}setFilter(e,n,o,s){j[e](this._coefficients,n,o,s),j.normalizeCoefficients(this._coefficients,this._normalizedCoefficients),j.calcImpulseResponse(this._impluseResponse,this._normalizedCoefficients)}transform(){for(let e=0;e<this.impulseLength;e++)this._real[e]=this._impluseResponse[e],this._imag[e]=0;Be(this._real,this._imag);for(let e=0;e<this.impulseLength/2;e++)this._phaseResponse[e]=Math.atan2(this._imag[e],this._real[e])*180/Math.PI,this._frequencyResponse[e]=Math.log10(Math.sqrt(this._real[e]*this._real[e]+this._imag[e]*this._imag[e]))*20}get coefficients(){return this._coefficients}get normalizedCoefficients(){return this._normalizedCoefficients}get impluseResponse(){return this._impluseResponse}get phaseResponse(){return this._phaseResponse}get frequencyResponse(){return this._frequencyResponse}static normalizeCoefficients(e,n){const o=n??new Float64Array(5);return o[0]=e[0]/e[3],o[1]=e[1]/e[3],o[2]=e[2]/e[3],o[3]=-e[4]/e[3],o[4]=-e[5]/e[3],o}static calcImpulseResponse(e,n){if(n.length!==5)throw new Error("Coefficients must to be normalized.");let[o,s,a,i,r]=[0,0,1,0,0];for(let l=0;l<e.length;l++)e[l]=n[0]*a+n[1]*i+n[2]*r+n[3]*o+n[4]*s,r=i,i=a,s=o,o=e[l],a=0}static calcOmega(e,n){return 2*Math.PI*n/e}static lowpass(e,n,o,s){const a=(s==null?void 0:s.q)??Math.SQRT1_2,i=j.calcOmega(n,o),r=Math.sin(i)/(2*a);return e[0]=(1-Math.cos(i))/2,e[1]=1-Math.cos(i),e[2]=(1-Math.cos(i))/2,e[3]=1+r,e[4]=-2*Math.cos(i),e[5]=1-r,e}static highpass(e,n,o,s){const a=(s==null?void 0:s.q)??Math.SQRT1_2,i=j.calcOmega(n,o),r=Math.sin(i)/(2*a);return e[0]=(1+Math.cos(i))/2,e[1]=-(1+Math.cos(i)),e[2]=(1+Math.cos(i))/2,e[3]=1+r,e[4]=-2*Math.cos(i),e[5]=1-r,e}static bandpass(e,n,o,s){const a=(s==null?void 0:s.q)??Math.SQRT1_2,i=j.calcOmega(n,o),r=Math.sin(i)/(2*a);return e[0]=r,e[1]=0,e[2]=-r,e[3]=1+r,e[4]=-2*Math.cos(i),e[5]=1-r,e}static bandstop(e,n,o,s){const a=(s==null?void 0:s.q)??Math.SQRT1_2,i=j.calcOmega(n,o),r=Math.sin(i)/(2*a);return e[0]=1,e[1]=-2*Math.cos(i),e[2]=1,e[3]=1+r,e[4]=-2*Math.cos(i),e[5]=1-r,e}static lowshelf(e,n,o,s){const a=(s==null?void 0:s.gain)??0,i=(s==null?void 0:s.q)??Math.SQRT1_2,r=j.calcOmega(n,o),l=Math.pow(10,a/40),u=Math.sqrt(l)/i;return e[0]=l*(l+1-(l-1)*Math.cos(r)+u*Math.sin(r)),e[1]=2*l*(l-1-(l+1)*Math.cos(r)),e[2]=l*(l+1-(l-1)*Math.cos(r)-u*Math.sin(r)),e[3]=l+1+(l-1)*Math.cos(r)+u*Math.sin(r),e[4]=-2*(l-1+(l+1)*Math.cos(r)),e[5]=l+1+(l-1)*Math.cos(r)-u*Math.sin(r),e}static highshelf(e,n,o,s){const a=(s==null?void 0:s.gain)??0,i=(s==null?void 0:s.q)??Math.SQRT1_2,r=j.calcOmega(n,o),l=Math.pow(10,a/40),u=Math.sqrt(l)/i;return e[0]=l*(l+1+(l-1)*Math.cos(r)+u*Math.sin(r)),e[1]=-2*l*(l-1+(l+1)*Math.cos(r)),e[2]=l*(l+1+(l-1)*Math.cos(r)-u*Math.sin(r)),e[3]=l+1-(l-1)*Math.cos(r)+u*Math.sin(r),e[4]=2*(l-1-(l+1)*Math.cos(r)),e[5]=l+1-(l-1)*Math.cos(r)-u*Math.sin(r),e}static peaking(e,n,o,s){const a=(s==null?void 0:s.gain)??0,i=(s==null?void 0:s.q)??Math.SQRT1_2,r=j.calcOmega(n,o),l=Math.sin(r)/(2*i),u=Math.pow(10,a/40);return e[0]=1+l*u,e[1]=-2*Math.cos(r),e[2]=1-l*u,e[3]=1+l/u,e[4]=-2*Math.cos(r),e[5]=1-l/u,e}static allpass(e,n,o,s){const a=(s==null?void 0:s.q)??Math.SQRT1_2,i=j.calcOmega(n,o),r=Math.sin(i)/(2*a);return e[0]=1-r,e[1]=-2*Math.cos(i),e[2]=1+r,e[3]=1+r,e[4]=-2*Math.cos(i),e[5]=1-r,e}};/*!
* chartjs-plugin-annotation v3.0.1
* https://www.chartjs.org/chartjs-plugin-annotation/index
 * (c) 2023 chartjs-plugin-annotation Contributors
 * Released under the MIT License
 */const It={modes:{point(t,e){return Fe(t,e,{intersect:!0})},nearest(t,e,n){return lo(t,e,n)},x(t,e,n){return Fe(t,e,{intersect:n.intersect,axis:"x"})},y(t,e,n){return Fe(t,e,{intersect:n.intersect,axis:"y"})}}};function lt(t,e,n){return(It.modes[n.mode]||It.modes.nearest)(t,e,n)}function ao(t,e,n){return n!=="x"&&n!=="y"?t.inRange(e.x,e.y,"x",!0)||t.inRange(e.x,e.y,"y",!0):t.inRange(e.x,e.y,n,!0)}function ro(t,e,n){return n==="x"?{x:t.x,y:e.y}:n==="y"?{x:e.x,y:t.y}:e}function Fe(t,e,n){return t.visibleElements.filter(o=>n.intersect?o.inRange(e.x,e.y):ao(o,e,n.axis))}function lo(t,e,n){let o=Number.POSITIVE_INFINITY;return Fe(t,e,n).reduce((s,a)=>{const i=a.getCenterPoint(),r=ro(e,i,n.axis),l=rt(e,r);return l<o?(s=[a],o=l):l===o&&s.push(a),s},[]).sort((s,a)=>s._index-a._index).slice(0,1)}const uo=(t,e)=>e>t||t.length>e.length&&t.slice(0,e.length)===e,Z=.001,Le=(t,e,n)=>Math.min(n,Math.max(e,t));function co(t,e,n){for(const o of Object.keys(t))t[o]=Le(t[o],e,n);return t}function fo(t,e,n,o){if(!t||!e||n<=0)return!1;const s=o/2;return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<=Math.pow(n+s,2)}function tn(t,{x:e,y:n,x2:o,y2:s},a,i){const r=i/2,l=t.x>=e-r-Z&&t.x<=o+r+Z,u=t.y>=n-r-Z&&t.y<=s+r+Z;return a==="x"?l:(a==="y"||l)&&u}function de(t,e){const{centerX:n,centerY:o}=t.getProps(["centerX","centerY"],e);return{x:n,y:o}}function ho(t,e,n,o=!0){const s=n.split(".");let a=0;for(const i of e.split(".")){const r=s[a++];if(parseInt(i,10)<parseInt(r,10))break;if(uo(r,i)){if(o)throw new Error(`${t} v${n} is not supported. v${e} or newer is required.`);return!1}}return!0}const nn=t=>typeof t=="string"&&t.endsWith("%"),on=t=>parseFloat(t)/100,sn=t=>Le(on(t),0,1),ze=(t,e)=>({x:t,y:e,x2:t,y2:e,width:0,height:0}),go={box:t=>ze(t.centerX,t.centerY),ellipse:t=>({centerX:t.centerX,centerY:t.centerX,radius:0,width:0,height:0}),label:t=>ze(t.centerX,t.centerY),line:t=>ze(t.x,t.y),point:t=>({centerX:t.centerX,centerY:t.centerY,radius:0,width:0,height:0}),polygon:t=>ze(t.centerX,t.centerY)};function ut(t,e){return e==="start"?0:e==="end"?t:nn(e)?sn(e)*t:t/2}function G(t,e,n=!0){return typeof e=="number"?e:nn(e)?(n?sn(e):on(e))*t:t}function yo(t,e){const{x:n,width:o}=t,s=e.textAlign;return s==="center"?n+o/2:s==="end"||s==="right"?n+o:n}function dt(t,e="center"){return xe(t)?{x:we(t.x,e),y:we(t.y,e)}:(t=we(t,e),{x:t,y:t})}function an(t){return t&&(N(t.xValue)||N(t.yValue))}function Me(t,e,n){const o=n.init;if(o){if(o===!0)return ln(e,n)}else return;return mo(t,e,n)}function rn(t,e,n){let o=!1;return e.forEach(s=>{re(t[s])?(o=!0,n[s]=t[s]):N(n[s])&&delete n[s]}),o}function ln(t,e){const n=e.type||"line";return go[n](t)}function mo(t,e,n){const o=at(n.init,[{chart:t,properties:e,options:n}]);if(o===!0)return ln(e,n);if(xe(o))return o}const Je=new Map,po=t=>isNaN(t)||t<=0,bo=t=>t.reduce(function(e,n){return e+=n.string,e},"");function Ne(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]"}}function ct(t,{x:e,y:n},o){o&&(t.translate(e,n),t.rotate(H(o)),t.translate(-e,-n))}function J(t,e){if(e&&e.borderWidth)return t.lineCap=e.borderCapStyle,t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,t.lineJoin=e.borderJoinStyle,t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,!0}function ce(t,e){t.shadowColor=e.backgroundShadowColor,t.shadowBlur=e.shadowBlur,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY}function ft(t,e){const n=e.content;if(Ne(n))return{width:G(n.width,e.width),height:G(n.height,e.height)};const o=e.font,s=ee(o)?o.map(l=>Ee(l)):[Ee(o)],a=e.textStrokeWidth,i=ee(n)?n:[n],r=i.join()+bo(s)+a+(t._measureText?"-spriting":"");return Je.has(r)||Je.set(r,Co(t,i,s,a)),Je.get(r)}function un(t,e,n){const{x:o,y:s,width:a,height:i}=e;t.save(),ce(t,n);const r=J(t,n);t.fillStyle=n.backgroundColor,t.beginPath(),$n(t,{x:o,y:s,w:a,h:i,radius:co(Xn(n.borderRadius),0,Math.min(a,i)/2)}),t.closePath(),t.fill(),r&&(t.shadowColor=n.borderShadowColor,t.stroke()),t.restore()}function vo(t,e,n){const o=n.content;if(Ne(o)){t.save(),t.globalAlpha=_o(n.opacity,o.style.opacity),t.drawImage(o,e.x,e.y,e.width,e.height),t.restore();return}const s=ee(o)?o:[o],a=n.font,i=ee(a)?a.map(g=>Ee(g)):[Ee(a)],r=n.color,l=ee(r)?r:[r],u=yo(e,n),h=e.y+n.textStrokeWidth/2;t.save(),t.textBaseline="middle",t.textAlign=n.textAlign,wo(t,n)&&ko(t,{x:u,y:h},s,i),So(t,{x:u,y:h},s,{fonts:i,colors:l}),t.restore()}function wo(t,e){if(e.textStrokeWidth>0)return t.lineJoin="round",t.miterLimit=2,t.lineWidth=e.textStrokeWidth,t.strokeStyle=e.textStrokeColor,!0}function xo(t,e,n,o){const{radius:s,options:a}=e,i=a.pointStyle,r=a.rotation;let l=(r||0)*Kt;if(Ne(i)){t.save(),t.translate(n,o),t.rotate(l),t.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),t.restore();return}po(s)||Mo(t,{x:n,y:o,radius:s,rotation:r,style:i,rad:l})}function Mo(t,{x:e,y:n,radius:o,rotation:s,style:a,rad:i}){let r,l,u,h;switch(t.beginPath(),a){default:t.arc(e,n,o,0,Qn),t.closePath();break;case"triangle":t.moveTo(e+Math.sin(i)*o,n-Math.cos(i)*o),i+=Ct,t.lineTo(e+Math.sin(i)*o,n-Math.cos(i)*o),i+=Ct,t.lineTo(e+Math.sin(i)*o,n-Math.cos(i)*o),t.closePath();break;case"rectRounded":h=o*.516,u=o-h,r=Math.cos(i+be)*u,l=Math.sin(i+be)*u,t.arc(e-r,n-l,h,i-E,i-De),t.arc(e+l,n-r,h,i-De,i),t.arc(e+r,n+l,h,i,i+De),t.arc(e-l,n+r,h,i+De,i+E),t.closePath();break;case"rect":if(!s){u=Math.SQRT1_2*o,t.rect(e-u,n-u,2*u,2*u);break}i+=be;case"rectRot":r=Math.cos(i)*o,l=Math.sin(i)*o,t.moveTo(e-r,n-l),t.lineTo(e+l,n-r),t.lineTo(e+r,n+l),t.lineTo(e-l,n+r),t.closePath();break;case"crossRot":i+=be;case"cross":r=Math.cos(i)*o,l=Math.sin(i)*o,t.moveTo(e-r,n-l),t.lineTo(e+r,n+l),t.moveTo(e+l,n-r),t.lineTo(e-l,n+r);break;case"star":r=Math.cos(i)*o,l=Math.sin(i)*o,t.moveTo(e-r,n-l),t.lineTo(e+r,n+l),t.moveTo(e+l,n-r),t.lineTo(e-l,n+r),i+=be,r=Math.cos(i)*o,l=Math.sin(i)*o,t.moveTo(e-r,n-l),t.lineTo(e+r,n+l),t.moveTo(e+l,n-r),t.lineTo(e-l,n+r);break;case"line":r=Math.cos(i)*o,l=Math.sin(i)*o,t.moveTo(e-r,n-l),t.lineTo(e+r,n+l);break;case"dash":t.moveTo(e,n),t.lineTo(e+Math.cos(i)*o,n+Math.sin(i)*o);break}t.fill()}function Co(t,e,n,o){t.save();const s=e.length;let a=0,i=o;for(let r=0;r<s;r++){const l=n[Math.min(r,n.length-1)];t.font=l.string;const u=e[r];a=Math.max(a,t.measureText(u).width+o),i+=l.lineHeight}return t.restore(),{width:a,height:i}}function ko(t,{x:e,y:n},o,s){t.beginPath();let a=0;o.forEach(function(i,r){const l=s[Math.min(r,s.length-1)],u=l.lineHeight;t.font=l.string,t.strokeText(i,e,n+u/2+a),a+=u}),t.stroke()}function So(t,{x:e,y:n},o,{fonts:s,colors:a}){let i=0;o.forEach(function(r,l){const u=a[Math.min(l,a.length-1)],h=s[Math.min(l,s.length-1)],g=h.lineHeight;t.beginPath(),t.font=h.string,t.fillStyle=u,t.fillText(r,e,n+g/2+i),i+=g,t.fill()})}function _o(t,e){const n=kt(t)?t:e;return kt(n)?Le(n,0,1):1}const Tt={xScaleID:{min:"xMin",max:"xMax",start:"left",end:"right",startProp:"x",endProp:"x2"},yScaleID:{min:"yMin",max:"yMax",start:"bottom",end:"top",startProp:"y",endProp:"y2"}};function le(t,e,n){return e=typeof e=="number"?e:t.parse(e),Jt(e)?t.getPixelForValue(e):n}function te(t,e,n){const o=e[n];if(o||n==="scaleID")return o;const s=n.charAt(0),a=Object.values(t).filter(i=>i.axis&&i.axis===s);return a.length?a[0].id:s}function dn(t,e){if(t){const n=t.options.reverse,o=le(t,e.min,n?e.end:e.start),s=le(t,e.max,n?e.start:e.end);return{start:o,end:s}}}function cn(t,e){const{chartArea:n,scales:o}=t,s=o[te(o,e,"xScaleID")],a=o[te(o,e,"yScaleID")];let i=n.width/2,r=n.height/2;return s&&(i=le(s,e.xValue,s.left+s.width/2)),a&&(r=le(a,e.yValue,a.top+a.height/2)),{x:i,y:r}}function ht(t,e){const n=t.scales,o=n[te(n,e,"xScaleID")],s=n[te(n,e,"yScaleID")];if(!o&&!s)return{};let{left:a,right:i}=o||t.chartArea,{top:r,bottom:l}=s||t.chartArea;const u=Dt(o,{min:e.xMin,max:e.xMax,start:a,end:i});a=u.start,i=u.end;const h=Dt(s,{min:e.yMin,max:e.yMax,start:l,end:r});return r=h.start,l=h.end,{x:a,y:r,x2:i,y2:l,width:i-a,height:l-r,centerX:a+(i-a)/2,centerY:r+(l-r)/2}}function fn(t,e){if(!an(e)){const n=ht(t,e);let o=e.radius;(!o||isNaN(o))&&(o=Math.min(n.width,n.height)/2,e.radius=o);const s=o*2,a=n.centerX+e.xAdjust,i=n.centerY+e.yAdjust;return{x:a-o,y:i-o,x2:a+o,y2:i+o,centerX:a,centerY:i,width:s,height:s,radius:o}}return Ao(t,e)}function Po(t,e){const{scales:n,chartArea:o}=t,s=n[e.scaleID],a={x:o.left,y:o.top,x2:o.right,y2:o.bottom};return s?Ro(s,a,e):Io(n,a,e),a}function hn(t,e){const n=ht(t,e);return n.initProperties=Me(t,n,e),n.elements=[{type:"label",optionScope:"label",properties:qo(t,n,e),initProperties:n.initProperties}],n}function Ao(t,e){const n=cn(t,e),o=e.radius*2;return{x:n.x-e.radius+e.xAdjust,y:n.y-e.radius+e.yAdjust,x2:n.x+e.radius+e.xAdjust,y2:n.y+e.radius+e.yAdjust,centerX:n.x+e.xAdjust,centerY:n.y+e.yAdjust,radius:e.radius,width:o,height:o}}function Dt(t,e){const n=dn(t,e)||e;return{start:Math.min(n.start,n.end),end:Math.max(n.start,n.end)}}function Ro(t,e,n){const o=le(t,n.value,NaN),s=le(t,n.endValue,o);t.isHorizontal()?(e.x=o,e.x2=s):(e.y=o,e.y2=s)}function Io(t,e,n){for(const o of Object.keys(Tt)){const s=t[te(t,n,o)];if(s){const{min:a,max:i,start:r,end:l,startProp:u,endProp:h}=Tt[o],g=dn(s,{min:n[a],max:n[i],start:s[r],end:s[l]});e[u]=g.start,e[h]=g.end}}}function To({properties:t,options:e},n,o,s){const{x:a,x2:i,width:r}=t;return gn({start:a,end:i,size:r,borderWidth:e.borderWidth},{position:o.x,padding:{start:s.left,end:s.right},adjust:e.label.xAdjust,size:n.width})}function Do({properties:t,options:e},n,o,s){const{y:a,y2:i,height:r}=t;return gn({start:a,end:i,size:r,borderWidth:e.borderWidth},{position:o.y,padding:{start:s.top,end:s.bottom},adjust:e.label.yAdjust,size:n.height})}function gn(t,e){const{start:n,end:o,borderWidth:s}=t,{position:a,padding:{start:i,end:r},adjust:l}=e,u=o-s-n-i-r-e.size;return n+s/2+l+ut(u,a)}function qo(t,e,n){const o=n.label;o.backgroundColor="transparent",o.callout.display=!1;const s=dt(o.position),a=We(o.padding),i=ft(t.ctx,o),r=To({properties:e,options:n},i,s,a),l=Do({properties:e,options:n},i,s,a),u=i.width+a.width,h=i.height+a.height;return{x:r,y:l,x2:r+u,y2:l+h,width:u,height:h,centerX:r+u/2,centerY:l+h/2,rotation:o.rotation}}function ne(t,e,n){const o=Math.cos(n),s=Math.sin(n),a=e.x,i=e.y;return{x:a+o*(t.x-a)-s*(t.y-i),y:i+s*(t.x-a)+o*(t.y-i)}}const Ze=["enter","leave"],gt=Ze.concat("click");function Oo(t,e,n){e.listened=rn(n,gt,e.listeners),e.moveListened=!1,e._getElements=lt,Ze.forEach(o=>{re(n[o])&&(e.moveListened=!0)}),(!e.listened||!e.moveListened)&&e.annotations.forEach(o=>{!e.listened&&re(o.click)&&(e.listened=!0),e.moveListened||Ze.forEach(s=>{re(o[s])&&(e.listened=!0,e.moveListened=!0)})})}function zo(t,e,n){if(t.listened)switch(e.type){case"mousemove":case"mouseout":return jo(t,e,n);case"click":return Fo(t,e,n)}}function jo(t,e,n){if(!t.moveListened)return;let o;e.type==="mousemove"?o=lt(t,e,n.interaction):o=[];const s=t.hovered;t.hovered=o;const a={state:t,event:e};let i=qt(a,"leave",s,o);return qt(a,"enter",o,s)||i}function qt({state:t,event:e},n,o,s){let a;for(const i of o)s.indexOf(i)<0&&(a=yn(i.options[n]||t.listeners[n],i,e)||a);return a}function Fo(t,e,n){const o=t.listeners,s=lt(t,e,n.interaction);let a;for(const i of s)a=yn(i.options.click||o.click,i,e)||a;return a}function yn(t,e,n){return at(t,[e.$context,n])===!0}const Ve=["afterDraw","beforeDraw"];function Eo(t,e,n){const o=e.visibleElements;e.hooked=rn(n,Ve,e.hooks),e.hooked||o.forEach(s=>{e.hooked||Ve.forEach(a=>{re(s.options[a])&&(e.hooked=!0)})})}function Ot(t,e,n){if(t.hooked){const o=e.options[n]||t.hooks[n];return at(o,[e.$context])}}function Bo(t,e,n){const o=Ho(t.scales,e,n);let s=zt(e,o,"min","suggestedMin");s=zt(e,o,"max","suggestedMax")||s,s&&re(e.handleTickRangeOptions)&&e.handleTickRangeOptions()}function Vo(t,e){for(const n of t)Lo(n,e)}function zt(t,e,n,o){if(Jt(e[n])&&!Wo(t.options,n,o)){const s=t[n]!==e[n];return t[n]=e[n],s}}function Wo(t,e,n){return N(t[e])||N(t[n])}function Lo(t,e){for(const n of["scaleID","xScaleID","yScaleID"]){const o=te(e,t,n);o&&!e[o]&&No(t,n)&&console.warn(`No scale found with id '${o}' for annotation '${t.id}'`)}}function No(t,e){if(e==="scaleID")return!0;const n=e.charAt(0);for(const o of["Min","Max","Value"])if(N(t[n+o]))return!0;return!1}function Ho(t,e,n){const o=e.axis,s=e.id,a=o+"ScaleID",i={min:we(e.min,Number.NEGATIVE_INFINITY),max:we(e.max,Number.POSITIVE_INFINITY)};for(const r of n)r.scaleID===s?jt(r,e,["value","endValue"],i):te(t,r,a)===s&&jt(r,e,[o+"Min",o+"Max",o+"Value"],i);return i}function jt(t,e,n,o){for(const s of n){const a=t[s];if(N(a)){const i=e.parse(a);o.min=Math.min(o.min,i),o.max=Math.max(o.max,i)}}}class fe extends ue{inRange(e,n,o,s){const{x:a,y:i}=ne({x:e,y:n},this.getCenterPoint(s),H(-this.options.rotation));return tn({x:a,y:i},this.getProps(["x","y","x2","y2"],s),o,this.options.borderWidth)}getCenterPoint(e){return de(this,e)}draw(e){e.save(),ct(e,this.getCenterPoint(),this.options.rotation),un(e,this,this.options),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return hn(e,n)}}fe.id="boxAnnotation";fe.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,label:{backgroundColor:"transparent",borderWidth:0,callout:{display:!1},color:"black",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,opacity:void 0,padding:6,position:"center",rotation:void 0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};fe.defaultRoutes={borderColor:"color",backgroundColor:"color"};fe.descriptors={label:{_fallback:!0}};const mn=["left","bottom","top","right"];class Ce extends ue{inRange(e,n,o,s){const{x:a,y:i}=ne({x:e,y:n},this.getCenterPoint(s),H(-this.rotation));return tn({x:a,y:i},this.getProps(["x","y","x2","y2"],s),o,this.options.borderWidth)}getCenterPoint(e){return de(this,e)}draw(e){const n=this.options,o=!N(this._visible)||this._visible;!n.display||!n.content||!o||(e.save(),ct(e,this.getCenterPoint(),this.rotation),$o(e,this),un(e,this,n),vo(e,Zo(this),n),e.restore())}resolveElementProperties(e,n){let o;if(an(n))o=cn(e,n);else{const{centerX:r,centerY:l}=ht(e,n);o={x:r,y:l}}const s=We(n.padding),a=ft(e.ctx,n),i=Yo(o,a,n,s);return{initProperties:Me(e,i,n),pointX:o.x,pointY:o.y,...i,rotation:n.rotation}}}Ce.id="labelAnnotation";Ce.defaults={adjustScaleRange:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:0,callout:{borderCapStyle:"butt",borderColor:void 0,borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:1,display:!1,margin:5,position:"auto",side:5,start:"50%"},color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,init:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};Ce.defaultRoutes={borderColor:"color"};function Yo(t,e,n,o){const s=e.width+o.width+n.borderWidth,a=e.height+o.height+n.borderWidth,i=dt(n.position,"center"),r=Ft(t.x,s,n.xAdjust,i.x),l=Ft(t.y,a,n.yAdjust,i.y);return{x:r,y:l,x2:r+s,y2:l+a,width:s,height:a,centerX:r+s/2,centerY:l+a/2}}function Ft(t,e,n=0,o){return t-ut(e,o)+n}function $o(t,e){const{pointX:n,pointY:o,options:s}=e,a=s.callout,i=a&&a.display&&Jo(e,a);if(!i||es(e,a,i))return;if(t.save(),t.beginPath(),!J(t,a))return t.restore();const{separatorStart:l,separatorEnd:u}=Xo(e,i),{sideStart:h,sideEnd:g}=Uo(e,i,l);(a.margin>0||s.borderWidth===0)&&(t.moveTo(l.x,l.y),t.lineTo(u.x,u.y)),t.moveTo(h.x,h.y),t.lineTo(g.x,g.y);const f=ne({x:n,y:o},e.getCenterPoint(),H(-e.rotation));t.lineTo(f.x,f.y),t.stroke(),t.restore()}function Xo(t,e){const{x:n,y:o,x2:s,y2:a}=t,i=Qo(t,e);let r,l;return e==="left"||e==="right"?(r={x:n+i,y:o},l={x:r.x,y:a}):(r={x:n,y:o+i},l={x:s,y:r.y}),{separatorStart:r,separatorEnd:l}}function Qo(t,e){const{width:n,height:o,options:s}=t,a=s.callout.margin+s.borderWidth/2;return e==="right"?n+a:e==="bottom"?o+a:-a}function Uo(t,e,n){const{y:o,width:s,height:a,options:i}=t,r=i.callout.start,l=Go(e,i.callout);let u,h;return e==="left"||e==="right"?(u={x:n.x,y:o+G(a,r)},h={x:u.x+l,y:u.y}):(u={x:n.x+G(s,r),y:n.y},h={x:u.x,y:u.y+l}),{sideStart:u,sideEnd:h}}function Go(t,e){const n=e.side;return t==="left"||t==="top"?-n:n}function Jo(t,e){const n=e.position;return mn.includes(n)?n:Ko(t,e)}function Ko(t,e){const{x:n,y:o,x2:s,y2:a,width:i,height:r,pointX:l,pointY:u,centerX:h,centerY:g,rotation:f}=t,b={x:h,y:g},x=e.start,T=G(i,x),k=G(r,x),D=[n,n+T,n+T,s],q=[o+k,a,o,a],z=[];for(let F=0;F<4;F++){const K=ne({x:D[F],y:q[F]},b,H(f));z.push({position:mn[F],distance:rt(K,{x:l,y:u})})}return z.sort((F,K)=>F.distance-K.distance)[0].position}function Zo({x:t,y:e,width:n,height:o,options:s}){const a=s.borderWidth/2,i=We(s.padding);return{x:t+i.left+a,y:e+i.top+a,width:n-i.left-i.right-s.borderWidth,height:o-i.top-i.bottom-s.borderWidth}}function es(t,e,n){const{pointX:o,pointY:s}=t,a=e.margin;let i=o,r=s;return n==="left"?i+=a:n==="right"?i-=a:n==="top"?r+=a:n==="bottom"&&(r-=a),t.inRange(i,r)}const yt=(t,e,n)=>({x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}),et=(t,e,n)=>yt(e,n,Math.abs((t-e.y)/(n.y-e.y))).x,Et=(t,e,n)=>yt(e,n,Math.abs((t-e.x)/(n.x-e.x))).y,ve=t=>t*t,ts=(t,e,{x:n,y:o,x2:s,y2:a},i)=>i==="y"?{start:Math.min(o,a),end:Math.max(o,a),value:e}:{start:Math.min(n,s),end:Math.max(n,s),value:t},Bt=(t,e,n,o)=>(1-o)*(1-o)*t+2*(1-o)*o*e+o*o*n,tt=(t,e,n,o)=>({x:Bt(t.x,e.x,n.x,o),y:Bt(t.y,e.y,n.y,o)}),Vt=(t,e,n,o)=>2*(1-o)*(e-t)+2*o*(n-e),Wt=(t,e,n,o)=>-Math.atan2(Vt(t.x,e.x,n.x,o),Vt(t.y,e.y,n.y,o))+.5*E;class ke extends ue{inRange(e,n,o,s){const a=this.options.borderWidth/2;if(o!=="x"&&o!=="y"){const i={mouseX:e,mouseY:n},{path:r,ctx:l}=this;if(r){J(l,this.options);const{chart:h}=this.$context,g=e*h.currentDevicePixelRatio,f=n*h.currentDevicePixelRatio,b=l.isPointInStroke(r,g,f)||nt(this,i,s);return l.restore(),b}const u=ve(a);return is(this,i,u,s)||nt(this,i,s)}return ns(this,{mouseX:e,mouseY:n},o,{hBorderWidth:a,useFinalPosition:s})}getCenterPoint(e){return de(this,e)}draw(e){const{x:n,y:o,x2:s,y2:a,cp:i,options:r}=this;if(e.save(),!J(e,r))return e.restore();ce(e,r);const l=Math.sqrt(Math.pow(s-n,2)+Math.pow(a-o,2));if(r.curve&&i)return hs(e,this,i,l),e.restore();const{startOpts:u,endOpts:h,startAdjust:g,endAdjust:f}=pn(this),b=Math.atan2(a-o,s-n);e.translate(n,o),e.rotate(b),e.beginPath(),e.moveTo(0+g,0),e.lineTo(l-f,0),e.shadowColor=r.borderShadowColor,e.stroke(),ot(e,0,g,u),ot(e,l,-f,h),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){const o=Po(e,n),{x:s,y:a,x2:i,y2:r}=o,l=os(o,e.chartArea),u=l?ss({x:s,y:a},{x:i,y:r},e.chartArea):{x:s,y:a,x2:i,y2:r,width:Math.abs(i-s),height:Math.abs(r-a)};if(u.centerX=(i+s)/2,u.centerY=(r+a)/2,u.initProperties=Me(e,u,n),n.curve){const g={x:u.x,y:u.y},f={x:u.x2,y:u.y2};u.cp=fs(u,n,rt(g,f))}const h=as(e,u,n.label);return h._visible=l,u.elements=[{type:"label",optionScope:"label",properties:h,initProperties:u.initProperties}],u}}ke.id="lineAnnotation";const Lt={backgroundColor:void 0,backgroundShadowColor:void 0,borderColor:void 0,borderDash:void 0,borderDashOffset:void 0,borderShadowColor:void 0,borderWidth:void 0,display:void 0,fill:void 0,length:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,width:void 0};ke.defaults={adjustScaleRange:!0,arrowHeads:{display:!1,end:Object.assign({},Lt),fill:!1,length:12,start:Object.assign({},Lt),width:6},borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:2,curve:!1,controlPoint:{y:"-50%"},display:!0,endValue:void 0,init:void 0,label:{backgroundColor:"rgba(0,0,0,0.8)",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderColor:"black",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:6,borderShadowColor:"transparent",borderWidth:0,callout:Object.assign({},Ce.defaults.callout),color:"#fff",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},scaleID:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,value:void 0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};ke.descriptors={arrowHeads:{start:{_fallback:!0},end:{_fallback:!0},_fallback:!0}};ke.defaultRoutes={borderColor:"color"};function ns(t,{mouseX:e,mouseY:n},o,{hBorderWidth:s,useFinalPosition:a}){const i=ts(e,n,t.getProps(["x","y","x2","y2"],a),o);return i.value>=i.start-s&&i.value<=i.end+s||nt(t,{mouseX:e,mouseY:n},a,o)}function os({x:t,y:e,x2:n,y2:o},{top:s,right:a,bottom:i,left:r}){return!(t<r&&n<r||t>a&&n>a||e<s&&o<s||e>i&&o>i)}function Nt({x:t,y:e},n,{top:o,right:s,bottom:a,left:i}){return t<i&&(e=Et(i,{x:t,y:e},n),t=i),t>s&&(e=Et(s,{x:t,y:e},n),t=s),e<o&&(t=et(o,{x:t,y:e},n),e=o),e>a&&(t=et(a,{x:t,y:e},n),e=a),{x:t,y:e}}function ss(t,e,n){const{x:o,y:s}=Nt(t,e,n),{x:a,y:i}=Nt(e,t,n);return{x:o,y:s,x2:a,y2:i,width:Math.abs(a-o),height:Math.abs(i-s)}}function is(t,{mouseX:e,mouseY:n},o=Z,s){const{x:a,y:i,x2:r,y2:l}=t.getProps(["x","y","x2","y2"],s),u=r-a,h=l-i,g=ve(u)+ve(h),f=g===0?-1:((e-a)*u+(n-i)*h)/g;let b,x;return f<0?(b=a,x=i):f>1?(b=r,x=l):(b=a+f*u,x=i+f*h),ve(e-b)+ve(n-x)<=o}function nt(t,{mouseX:e,mouseY:n},o,s){const a=t.label;return a.options.display&&a.inRange(e,n,s,o)}function as(t,e,n){const o=n.borderWidth,s=We(n.padding),a=ft(t.ctx,n),i=a.width+s.width+o,r=a.height+s.height+o;return ls(e,n,{width:i,height:r,padding:s},t.chartArea)}function rs(t){const{x:e,y:n,x2:o,y2:s}=t,a=Math.atan2(s-n,o-e);return a>E/2?a-E:a<E/-2?a+E:a}function ls(t,e,n,o){const{width:s,height:a,padding:i}=n,{xAdjust:r,yAdjust:l}=e,u={x:t.x,y:t.y},h={x:t.x2,y:t.y2},g=e.rotation==="auto"?rs(t):H(e.rotation),f=us(s,a,g),b=ds(t,e,{labelSize:f,padding:i},o),x=t.cp?tt(u,t.cp,h,b):yt(u,h,b),T={size:f.w,min:o.left,max:o.right,padding:i.left},k={size:f.h,min:o.top,max:o.bottom,padding:i.top},D=Yt(x.x,T)+r,q=Yt(x.y,k)+l;return{x:D-s/2,y:q-a/2,x2:D+s/2,y2:q+a/2,centerX:D,centerY:q,pointX:x.x,pointY:x.y,width:s,height:a,rotation:Hn(g)}}function us(t,e,n){const o=Math.cos(n),s=Math.sin(n);return{w:Math.abs(t*o)+Math.abs(e*s),h:Math.abs(t*s)+Math.abs(e*o)}}function ds(t,e,n,o){let s;const a=cs(t,o);return e.position==="start"?s=Ht({w:t.x2-t.x,h:t.y2-t.y},n,e,a):e.position==="end"?s=1-Ht({w:t.x-t.x2,h:t.y-t.y2},n,e,a):s=ut(1,e.position),s}function Ht(t,e,n,o){const{labelSize:s,padding:a}=e,i=t.w*o.dx,r=t.h*o.dy,l=i>0&&(s.w/2+a.left-o.x)/i,u=r>0&&(s.h/2+a.top-o.y)/r;return Le(Math.max(l,u),0,.25)}function cs(t,e){const{x:n,x2:o,y:s,y2:a}=t,i=Math.min(s,a)-e.top,r=Math.min(n,o)-e.left,l=e.bottom-Math.max(s,a),u=e.right-Math.max(n,o);return{x:Math.min(r,u),y:Math.min(i,l),dx:r<=u?1:-1,dy:i<=l?1:-1}}function Yt(t,e){const{size:n,min:o,max:s,padding:a}=e,i=n/2;return n>s-o?(s+o)/2:(o>=t-a-i&&(t=o+a+i),s<=t+a+i&&(t=s-a-i),t)}function pn(t){const e=t.options,n=e.arrowHeads&&e.arrowHeads.start,o=e.arrowHeads&&e.arrowHeads.end;return{startOpts:n,endOpts:o,startAdjust:$t(t,n),endAdjust:$t(t,o)}}function $t(t,e){if(!e||!e.display)return 0;const{length:n,width:o}=e,s=t.options.borderWidth/2,a={x:n,y:o+s};return Math.abs(et(0,a,{x:0,y:s}))}function ot(t,e,n,o){if(!o||!o.display)return;const{length:s,width:a,fill:i,backgroundColor:r,borderColor:l}=o,u=Math.abs(e-s)+n;t.beginPath(),ce(t,o),J(t,o),t.moveTo(u,-a),t.lineTo(e+n,0),t.lineTo(u,a),i===!0?(t.fillStyle=r||l,t.closePath(),t.fill(),t.shadowColor="transparent"):t.shadowColor=o.borderShadowColor,t.stroke()}function fs(t,e,n){const{x:o,y:s,x2:a,y2:i,centerX:r,centerY:l}=t,u=Math.atan2(i-s,a-o),h=dt(e.controlPoint,0),g={x:r+G(n,h.x,!1),y:l+G(n,h.y,!1)};return ne(g,{x:r,y:l},u)}function Xt(t,{x:e,y:n},{angle:o,adjust:s},a){!a||!a.display||(t.save(),t.translate(e,n),t.rotate(o),ot(t,0,-s,a),t.restore())}function hs(t,e,n,o){const{x:s,y:a,x2:i,y2:r,options:l}=e,{startOpts:u,endOpts:h,startAdjust:g,endAdjust:f}=pn(e),b={x:s,y:a},x={x:i,y:r},T=Wt(b,n,x,0),k=Wt(b,n,x,1)-E,D=tt(b,n,x,g/o),q=tt(b,n,x,1-f/o),z=new Path2D;t.beginPath(),z.moveTo(D.x,D.y),z.quadraticCurveTo(n.x,n.y,q.x,q.y),t.shadowColor=l.borderShadowColor,t.stroke(z),e.path=z,e.ctx=t,Xt(t,D,{angle:T,adjust:g},u),Xt(t,q,{angle:k,adjust:f},h)}class Se extends ue{inRange(e,n,o,s){const a=this.options.rotation,i=this.options.borderWidth;if(o!=="x"&&o!=="y")return gs({x:e,y:n},this.getProps(["width","height","centerX","centerY"],s),a,i);const{x:r,y:l,x2:u,y2:h}=this.getProps(["x","y","x2","y2"],s),g=i/2,f=o==="y"?{start:l,end:h}:{start:r,end:u},b=ne({x:e,y:n},this.getCenterPoint(s),H(-a));return b[o]>=f.start-g-Z&&b[o]<=f.end+g+Z}getCenterPoint(e){return de(this,e)}draw(e){const{width:n,height:o,centerX:s,centerY:a,options:i}=this;e.save(),ct(e,this.getCenterPoint(),i.rotation),ce(e,this.options),e.beginPath(),e.fillStyle=i.backgroundColor;const r=J(e,i);e.ellipse(s,a,o/2,n/2,E/2,0,2*E),e.fill(),r&&(e.shadowColor=i.borderShadowColor,e.stroke()),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,n){return hn(e,n)}}Se.id="ellipseAnnotation";Se.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,label:Object.assign({},fe.defaults.label),rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};Se.defaultRoutes={borderColor:"color",backgroundColor:"color"};Se.descriptors={label:{_fallback:!0}};function gs(t,e,n,o){const{width:s,height:a,centerX:i,centerY:r}=e,l=s/2,u=a/2;if(l<=0||u<=0)return!1;const h=H(n||0),g=o/2||0,f=Math.cos(h),b=Math.sin(h),x=Math.pow(f*(t.x-i)+b*(t.y-r),2),T=Math.pow(b*(t.x-i)-f*(t.y-r),2);return x/Math.pow(l+g,2)+T/Math.pow(u+g,2)<=1.0001}class He extends ue{inRange(e,n,o,s){const{x:a,y:i,x2:r,y2:l,width:u}=this.getProps(["x","y","x2","y2","width"],s),h=this.options.borderWidth;if(o!=="x"&&o!=="y")return fo({x:e,y:n},this.getCenterPoint(s),u/2,h);const g=h/2,f=o==="y"?{start:i,end:l,value:n}:{start:a,end:r,value:e};return f.value>=f.start-g&&f.value<=f.end+g}getCenterPoint(e){return de(this,e)}draw(e){const n=this.options,o=n.borderWidth;if(n.radius<.1)return;e.save(),e.fillStyle=n.backgroundColor,ce(e,n);const s=J(e,n);xo(e,this,this.centerX,this.centerY),s&&!Ne(n.pointStyle)&&(e.shadowColor=n.borderShadowColor,e.stroke()),e.restore(),n.borderWidth=o}resolveElementProperties(e,n){const o=fn(e,n);return o.initProperties=Me(e,o,n),o}}He.id="pointAnnotation";He.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,pointStyle:"circle",radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};He.defaultRoutes={borderColor:"color",backgroundColor:"color"};class Ye extends ue{inRange(e,n,o,s){if(o!=="x"&&o!=="y")return this.options.radius>=.1&&this.elements.length>1&&ms(this.elements,e,n,s);const a=ne({x:e,y:n},this.getCenterPoint(s),H(-this.options.rotation)),i=this.elements.map(u=>o==="y"?u.bY:u.bX),r=Math.min(...i),l=Math.max(...i);return a[o]>=r&&a[o]<=l}getCenterPoint(e){return de(this,e)}draw(e){const{elements:n,options:o}=this;e.save(),e.beginPath(),e.fillStyle=o.backgroundColor,ce(e,o);const s=J(e,o);let a=!0;for(const i of n)a?(e.moveTo(i.x,i.y),a=!1):e.lineTo(i.x,i.y);e.closePath(),e.fill(),s&&(e.shadowColor=o.borderShadowColor,e.stroke()),e.restore()}resolveElementProperties(e,n){const o=fn(e,n),{sides:s,rotation:a}=n,i=[],r=2*E/s;let l=a*Kt;for(let u=0;u<s;u++,l+=r){const h=ys(o,n,l);h.initProperties=Me(e,o,n),i.push(h)}return o.elements=i,o}}Ye.id="polygonAnnotation";Ye.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,point:{radius:0},radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,sides:3,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};Ye.defaultRoutes={borderColor:"color",backgroundColor:"color"};function ys({centerX:t,centerY:e},{radius:n,borderWidth:o},s){const a=o/2,i=Math.sin(s),r=Math.cos(s),l={x:t+i*n,y:e-r*n};return{type:"point",optionScope:"point",properties:{x:l.x,y:l.y,centerX:l.x,centerY:l.y,bX:t+i*(n+a),bY:e-r*(n+a)}}}function ms(t,e,n,o){let s=!1,a=t[t.length-1].getProps(["bX","bY"],o);for(const i of t){const r=i.getProps(["bX","bY"],o);r.bY>n!=a.bY>n&&e<(a.bX-r.bX)*(n-r.bY)/(a.bY-r.bY)+r.bX&&(s=!s),a=r}return s}const U={box:fe,ellipse:Se,label:Ce,line:ke,point:He,polygon:Ye};Object.keys(U).forEach(t=>{Wn.describe(`elements.${U[t].id}`,{_fallback:"plugins.annotation.common"})});const ps={update:Object.assign},bs=gt.concat(Ve),Qt=(t,e)=>xe(e)?it(t,e):t,st=t=>t==="color"||t==="font";function mt(t="line"){return U[t]?t:(console.warn(`Unknown annotation type: '${t}', defaulting to 'line'`),"line")}function vs(t,e,n,o){const s=xs(t,n.animations,o),a=e.annotations,i=ks(e.elements,a);for(let r=0;r<a.length;r++){const l=a[r],u=bn(i,r,l.type),h=l.setContext(Cs(t,u,l)),g=u.resolveElementProperties(t,h);g.skip=ws(g),"elements"in g&&(Ms(u,g.elements,h,s),delete g.elements),N(u.x)||Object.assign(u,g),Object.assign(u,g.initProperties),g.options=vn(h),s.update(u,g)}}function ws(t){return isNaN(t.x)||isNaN(t.y)}function xs(t,e,n){return n==="reset"||n==="none"||n==="resize"?ps:new Yn(t,e)}function Ms(t,e,n,o){const s=t.elements||(t.elements=[]);s.length=e.length;for(let a=0;a<e.length;a++){const i=e[a],r=i.properties,l=bn(s,a,i.type,i.initProperties),u=n[i.optionScope].override(i);r.options=vn(u),o.update(l,r)}}function bn(t,e,n,o){const s=U[mt(n)];let a=t[e];return(!a||!(a instanceof s))&&(a=t[e]=new s,Object.assign(a,o)),a}function vn(t){const e=U[mt(t.type)],n={};n.id=t.id,n.type=t.type,n.drawTime=t.drawTime,Object.assign(n,it(t,e.defaults),it(t,e.defaultRoutes));for(const o of bs)n[o]=t[o];return n}function it(t,e){const n={};for(const o of Object.keys(e)){const s=e[o],a=t[o];st(o)&&ee(a)?n[o]=a.map(i=>Qt(i,s)):n[o]=Qt(a,s)}return n}function Cs(t,e,n){return e.$context||(e.$context=Object.assign(Object.create(t.getContext()),{element:e,id:n.id,type:"annotation"}))}function ks(t,e){const n=e.length,o=t.length;if(o<n){const s=n-o;t.splice(o,0,...new Array(s))}else o>n&&t.splice(n,o-n);return t}var Ss="3.0.1";const Q=new Map,_s=gt.concat(Ve);var Ps={id:"annotation",version:Ss,beforeRegister(){ho("chart.js","4.0",ae.version)},afterRegister(){ae.register(U)},afterUnregister(){ae.unregister(U)},beforeInit(t){Q.set(t,{annotations:[],elements:[],visibleElements:[],listeners:{},listened:!1,moveListened:!1,hooks:{},hooked:!1,hovered:[]})},beforeUpdate(t,e,n){const o=Q.get(t),s=o.annotations=[];let a=n.annotations;xe(a)?Object.keys(a).forEach(i=>{const r=a[i];xe(r)&&(r.id=i,s.push(r))}):ee(a)&&s.push(...a),Vo(s,t.scales)},afterDataLimits(t,e){const n=Q.get(t);Bo(t,e.scale,n.annotations.filter(o=>o.display&&o.adjustScaleRange))},afterUpdate(t,e,n){const o=Q.get(t);Oo(t,o,n),vs(t,o,n,e.mode),o.visibleElements=o.elements.filter(s=>!s.skip&&s.options.display),Eo(t,o,n)},beforeDatasetsDraw(t,e,n){je(t,"beforeDatasetsDraw",n.clip)},afterDatasetsDraw(t,e,n){je(t,"afterDatasetsDraw",n.clip)},beforeDraw(t,e,n){je(t,"beforeDraw",n.clip)},afterDraw(t,e,n){je(t,"afterDraw",n.clip)},beforeEvent(t,e,n){const o=Q.get(t);zo(o,e.event,n)&&(e.changed=!0)},afterDestroy(t){Q.delete(t)},_getState(t){return Q.get(t)},defaults:{animations:{numbers:{properties:["x","y","x2","y2","width","height","centerX","centerY","pointX","pointY","radius"],type:"number"}},clip:!0,interaction:{mode:void 0,axis:void 0,intersect:void 0},common:{drawTime:"afterDatasetsDraw",init:!1,label:{}}},descriptors:{_indexable:!1,_scriptable:t=>!_s.includes(t)&&t!=="init",annotations:{_allKeys:!1,_fallback:(t,e)=>`elements.${U[mt(e.type)].id}`},interaction:{_fallback:!0},common:{label:{_indexable:st,_fallback:!0},_indexable:st}},additionalOptionScopes:[""]};function je(t,e,n){const{ctx:o,chartArea:s}=t,a=Q.get(t);n&&Ln(o,s);const i=As(a.visibleElements,e).sort((r,l)=>r.element.options.z-l.element.options.z);for(const r of i)Rs(o,s,a,r);n&&Nn(o)}function As(t,e){const n=[];for(const o of t)if(o.options.drawTime===e&&n.push({element:o,main:!0}),o.elements&&o.elements.length)for(const s of o.elements)s.options.display&&s.options.drawTime===e&&n.push({element:s});return n}function Rs(t,e,n,o){const s=o.element;o.main?(Ot(n,s,"beforeDraw"),s.draw(t,e),Ot(n,s,"afterDraw")):s.draw(t,e)}class pt extends _t{constructor(){const e=Zt(pt.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(_t.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(en(e in Ut,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const n=this.now();this._stop(n),this._start(n)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const n=Ut[this._type];this._source=new Un({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(n.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const ie=44100*5,Ke=2,L={brown:null,pink:null,white:null},Ut={get brown(){if(!L.brown){const t=[];for(let e=0;e<Ke;e++){const n=new Float32Array(ie);t[e]=n;let o=0;for(let s=0;s<ie;s++){const a=Math.random()*2-1;n[s]=(o+.02*a)/1.02,o=n[s],n[s]*=3.5}}L.brown=new Ue().fromArray(t)}return L.brown},get pink(){if(!L.pink){const t=[];for(let e=0;e<Ke;e++){const n=new Float32Array(ie);t[e]=n;let o,s,a,i,r,l,u;o=s=a=i=r=l=u=0;for(let h=0;h<ie;h++){const g=Math.random()*2-1;o=.99886*o+g*.0555179,s=.99332*s+g*.0750759,a=.969*a+g*.153852,i=.8665*i+g*.3104856,r=.55*r+g*.5329522,l=-.7616*l-g*.016898,n[h]=o+s+a+i+r+l+u+g*.5362,n[h]*=.11,u=g*.115926}}L.pink=new Ue().fromArray(t)}return L.pink},get white(){if(!L.white){const t=[];for(let e=0;e<Ke;e++){const n=new Float32Array(ie);t[e]=n;for(let o=0;o<ie;o++)n[o]=Math.random()*2-1}L.white=new Ue().fromArray(t)}return L.white}};class bt extends Pt{constructor(){const e=Zt(bt.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new qe({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new qe({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new qe({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new qe({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(Pt.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){en(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const n=new Float32Array(e);for(let i=0;i<e;i++){const l=Math.pow(i/e,2)*19980+20;n[i]=l}const o=new Float32Array(e),s=new Float32Array(e),a=this.context.createBiquadFilter();return a.type=this.type,a.Q.value=this.Q.value,a.frequency.value=this.frequency.value,a.gain.value=this.gain.value,a.getFrequencyResponse(n,o,s),o}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}function Is(t){return new Worker("/tools/assets/biquadWorker-6gQMUHmi.js",{name:t==null?void 0:t.name})}const Gt=[{title:"ローパスフィルタ (LPF)",value:"lowpass",requiredParameter:["q"],toneFilterType:"lowpass"},{title:"ハイパスフィルタ (HPF)",value:"highpass",requiredParameter:["q"],toneFilterType:"highpass"},{title:"バンドパスフィルタ (BPF)",value:"bandpass",requiredParameter:["q"],toneFilterType:"bandpass"},{title:"バンドストップフィルタ (BSF, Notch)",value:"bandstop",requiredParameter:["q"],toneFilterType:"notch"},{title:"ローシェルフフィルタ (LSF)",value:"lowshelf",requiredParameter:["q","gain"],toneFilterType:"lowshelf"},{title:"ハイシェルフフィルタ (HSF)",value:"highshelf",requiredParameter:["q","gain"],toneFilterType:"highshelf"},{title:"ピーキングフィルタ (Peaking)",value:"peaking",requiredParameter:["q","gain"],toneFilterType:"peaking"},{title:"オールパスフィルタ (Allpass)",value:"allpass",requiredParameter:["q"],toneFilterType:"allpass"}],Ts={type:"line",data:{datasets:[],labels:[]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{},parsing:{xAxisKey:"x",yAxisKey:"y"},scales:{x:{type:"logarithmic",min:20},y:{type:"linear",min:-60},y1:{type:"linear",position:"right",max:180,min:-180,ticks:{stepSize:90},grid:{drawOnChartArea:!1}}}}},Ds={type:"bar",data:{datasets:[]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{type:"linear"}},plugins:{legend:{labels:{usePointStyle:!0}}}}},qs={type:"line",borderColor:"#aaa",borderWidth:2,borderDash:[5]},Os={style:{height:"250px"}},zs={style:{height:"250px"}},js={class:"ml-3"},Fs={class:"text-right"},Es={class:"text-right"},Bs={class:"text-right"},Vs={class:"text-right"},Ws={class:"text-right"},Ls={class:"text-right"},Ns={class:"ml-3"},Hs={class:"text-right"},Ys={class:"text-right"},$s={class:"text-right"},Xs={class:"text-right"},Qs={class:"text-right"},Us={class:"text-right"},Gs={class:"text-right"},Js=Dn({__name:"BiquadApp",setup(t){ae.register(Ps);const e=qn(),n=C(),o=C(Gt[0]),s=C(),a=C(),i=C(-60),r=C(!1),l=C(1e3),u=C(.707106781),h=C(6),g=C(48e3),f=C(1024),b=C(1024/4),x=C(1024),T=C(2**16),k=Mt(()=>new io(f.value)),D=C([1,0,0,0,0,0]),q=C([1,0,0,0,0]),z=C(0),F=C(0),K=C(0),$e=C(0),Xe=C(0),Qe=C(0),_e=Mt(()=>eo(g.value/2,f.value/2)),Y=C(),he=C(-30),Pe=C(-1/0);let V=null,Ae=null,ge=null;const{data:wn,post:xn}=Bn(new Is);function Mn(){function v(_,S,O){Te(_==null?void 0:_.getElementById(S),{textContent:O})}const d=window.document.querySelector(".diagram");if(d){const _=d.contentDocument;v(_,"b0",k.value.normalizedCoefficients[0].toFixed(9)),v(_,"b1",k.value.normalizedCoefficients[1].toFixed(9)),v(_,"b2",k.value.normalizedCoefficients[2].toFixed(9)),v(_,"a1",k.value.normalizedCoefficients[3].toFixed(9)),v(_,"a2",k.value.normalizedCoefficients[4].toFixed(9))}}function vt(){var _,S,O,w,ye;const v=(_=s.value)==null?void 0:_.getChart();if(!v||!v.ready)return;function d(){const oe=[];let $=k.value.phaseResponse[0];for(let W=1;W<f.value;W++){const me=k.value.phaseResponse[W];Math.abs(me-$)>=180&&W<f.value-1&&oe.push({x:(_e.value[W]+_e.value[W+1])/2,y:Number.NaN}),oe.push({x:_e.value[W],y:me}),$=me}return oe}Te((O=(S=v.chart.options.plugins)==null?void 0:S.annotation)==null?void 0:O.annotations,{cutoffFreqLine:new Vn(Object.assign({xMax:l.value,xMin:l.value},qs))}),Te(v.chart,{data:{datasets:[{label:"振幅 (dB)",data:k.value.frequencyResponse,pointStyle:!1,yAxisID:"y",hidden:typeof((w=v.chart.data.datasets[0])==null?void 0:w.hidden)>"u"?!1:!v.chart.isDatasetVisible(0)},{label:"位相 (deg)",data:d(),pointStyle:!1,yAxisID:"y1",hidden:typeof((ye=v.chart.data.datasets[1])==null?void 0:ye.hidden)>"u"?!1:!v.chart.isDatasetVisible(1)}],labels:_e.value},scales:{x:{options:{max:g.value/2,min:200/2**(Math.log2(f.value)-8)}},y:{options:{max:Math.round(Math.max(Rt(k.value.frequencyResponse).max,0)+10),min:i.value}}}}).update("none")}function wt(){var d,_;const v=(d=a.value)==null?void 0:d.getChart();!v||!v.ready||Te(v.chart,{data:{datasets:[{label:"インパルス応答",data:k.value.impluseResponse.slice(0,b.value),pointStyle:"rect",borderWidth:0,backgroundColor:"rgb(54, 162, 235)",barPercentage:1.2,hidden:typeof((_=v.chart.data.datasets[0])==null?void 0:_.hidden)>"u"?!1:!v.chart.isDatasetVisible(0)}],labels:At(b.value)}}).update("none")}function xt(){x.value=f.value,k.value.setFilter(o.value.value,g.value,l.value,{q:u.value,gain:h.value}),D.value=[...k.value.coefficients],q.value=[...k.value.normalizedCoefficients],k.value.transform(),z.value=(k.value.frequencyResponse[Math.floor(l.value/g.value*f.value)]+k.value.frequencyResponse[Math.floor(l.value/g.value*f.value+1)])/2;const v=Rt(k.value.frequencyResponse);F.value=v.max,K.value=v.min,$e.value=g.value/f.value*v.maxIndex,Xe.value=g.value/f.value*v.minIndex,Qe.value=k.value.impluseResponse.reduce((d,_)=>d+_,0),Mn(),vt(),wt()}pe(()=>[f.value,o.value,l.value,u.value,h.value,g.value],()=>{b.value>f.value&&(b.value=f.value),xt(),ge&&ge.set({frequency:l.value,Q:u.value,gain:h.value,type:o.value.toneFilterType})}),pe(()=>i.value,vt),pe(()=>b.value,wt);function Cn(){Fn(e),xt(),n.value&&(n.value.style.opacity="1")}function kn(v){return new ae(v,Ts)}function Sn(v){return new ae(v,Ds)}async function _n(){Y.value?V==null||V.stop():(V==null&&(await Gn(),ge=new bt({frequency:l.value,Q:u.value,gain:h.value}).toDestination(),V=new pt().connect(ge),Ae=new Jn({smoothing:0}),ge.connect(Ae)),V.volume.value=he.value,V.start())}pe(()=>he.value,()=>{V&&(V.volume.value=he.value)}),Kn(()=>{if(Ae){const v=Ae.getValue();Pe.value=Array.isArray(v)?v[0]:v}},200);async function Pn(){r.value||(r.value=!0,xn({impulseLength:T.value,filterType:o.value.value,samplingFreq:g.value,cutoffFreq:l.value,q:u.value,gain:h.value}))}return pe(()=>wn.value,v=>{({magnitudeOnCutoff:z.value,maxMagnitude:F.value,minMagnitude:K.value,maxMagnitudeFrequency:$e.value,minMagnitudeFrequency:Xe.value,sumImpulse:Qe.value}=v),x.value=T.value,r.value=!1}),(v,d)=>{const _=B("v-select"),S=B("v-col"),O=B("v-row"),w=B("v-list-item"),ye=B("v-icon"),oe=B("v-btn"),$=B("v-divider"),W=B("v-checkbox"),me=B("v-container"),An=B("v-footer");return Re(),Ie(jn,{"page-id":"filter/biquad","toolbar-title":"双2次フィルタ"},{footer:y(()=>[c($),c(An,null,{default:y(()=>[c(me,null,{default:y(()=>d[67]||(d[67]=[m("h4",null,"参考文献",-1),m("ul",null,[m("li",null,[m("a",{href:"https://webaudio.github.io/Audio-EQ-Cookbook/audio-eq-cookbook.html",target:"_blank"},"Cookbook formulae for audio equalizer biquad filter coefficients")]),m("li",null,[m("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/BiquadFilterNode/type",target:"_blank"},"BiquadFilterNode: type property"),M(" - Web APIs | MDN ")])],-1)])),_:1})]),_:1})]),default:y(()=>[c(O,null,{default:y(()=>[c(S,{cols:"12",md:"7"},{default:y(()=>[c(O,null,{default:y(()=>[c(S,{cols:"12"},{default:y(()=>[c(_,{label:"フィルタタイプ",density:"compact",variant:"underlined",modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=p=>o.value=p),items:A(Gt),"hide-details":"","return-object":""},null,8,["modelValue","items"])]),_:1})]),_:1}),c(se,{modelValue:l.value,"onUpdate:modelValue":d[5]||(d[5]=p=>l.value=p),label:"カットオフ周波数",variant:"underlined",density:"compact",unit:"Hz",scale:"log",max:g.value/2,min:10,"fraction-digits":3,"prefix-symbols":["G","M","k",""],rule:[A(I).required,A(I).value,A(I).notNegative,A(I).notZero],cols:"4","hide-details":""},{"menu-list":y(()=>[c(w,{title:"10 kHz",onClick:d[1]||(d[1]=p=>l.value=1e4)}),c(w,{title:"1 kHz",onClick:d[2]||(d[2]=p=>l.value=1e3)}),c(w,{title:"100 Hz",onClick:d[3]||(d[3]=p=>l.value=100)}),c(w,{title:"10 Hz",onClick:d[4]||(d[4]=p=>l.value=10)})]),_:1},8,["modelValue","max","rule"]),c(se,{modelValue:u.value,"onUpdate:modelValue":d[14]||(d[14]=p=>u.value=p),label:"Q",variant:"underlined",density:"compact",scale:"log",max:128,min:.01,"fraction-digits":4,rule:[A(I).required,A(I).value,A(I).notNegative,A(I).notZero],cols:"4","hide-details":""},{"menu-button":y(({props:p})=>[c(oe,On(p,{icon:"",variant:"plain",density:"compact"}),{default:y(()=>[(o.value.value==="lowshelf"||o.value.value==="highshelf")&&Y.value?(Re(),Ie(ye,{key:0,color:"warning",icon:"mdi-alert"})):(Re(),Ie(ye,{key:1,icon:"mdi-dots-horizontal"}))]),_:2},1040)]),"menu-list":y(()=>[(o.value.value==="lowshelf"||o.value.value==="highshelf")&&Y.value?(Re(),Ie(w,{key:0,title:"再生される音には Q のパラメータは反映されません",color:"warning",active:"",density:"compact"})):zn("",!0),c(w,{title:"16.0000",onClick:d[6]||(d[6]=p=>u.value=Math.pow(Math.SQRT2,8))}),c(w,{title:"8.0000",onClick:d[7]||(d[7]=p=>u.value=Math.pow(Math.SQRT2,6))}),c(w,{title:"4.0000",onClick:d[8]||(d[8]=p=>u.value=Math.pow(Math.SQRT2,4))}),c(w,{title:"2.0000",onClick:d[9]||(d[9]=p=>u.value=Math.pow(Math.SQRT2,2))}),c(w,{title:"1.4142",onClick:d[10]||(d[10]=p=>u.value=Math.SQRT2)}),c(w,{title:"1.0000",onClick:d[11]||(d[11]=p=>u.value=1)}),c(w,{title:"0.7071 (デフォルト)",onClick:d[12]||(d[12]=p=>u.value=Math.SQRT1_2)}),c(w,{title:"0.5000",onClick:d[13]||(d[13]=p=>u.value=.5)})]),_:1},8,["modelValue","rule"]),c(se,{modelValue:h.value,"onUpdate:modelValue":d[22]||(d[22]=p=>h.value=p),label:"増幅量",variant:"underlined",density:"compact",unit:"dB",max:40,min:-40,step:.1,"fraction-digits":2,rule:[A(I).required,A(I).value],cols:"4","hide-details":"",disabled:!o.value.requiredParameter.includes("gain")},{"menu-list":y(()=>[c(w,{title:"+ 9.00 dB",onClick:d[15]||(d[15]=p=>h.value=9)}),c(w,{title:"+ 6.00 dB",onClick:d[16]||(d[16]=p=>h.value=6)}),c(w,{title:"+ 3.00 dB",onClick:d[17]||(d[17]=p=>h.value=3)}),c(w,{title:" 0.00 dB",onClick:d[18]||(d[18]=p=>h.value=0)}),c(w,{title:"- 3.00 dB",onClick:d[19]||(d[19]=p=>h.value=-3)}),c(w,{title:"- 6.00 dB",onClick:d[20]||(d[20]=p=>h.value=-6)}),c(w,{title:"- 9.00 dB",onClick:d[21]||(d[21]=p=>h.value=-9)})]),_:1},8,["modelValue","rule","disabled"]),c(se,{modelValue:g.value,"onUpdate:modelValue":d[30]||(d[30]=p=>g.value=p),label:"サンプリング周波数",variant:"underlined",density:"compact",unit:"Hz",scale:"log",max:192e3,min:10,"fraction-digits":3,"prefix-symbols":["G","M","k",""],rule:[A(I).required,A(I).value,A(I).notNegative,A(I).notZero],cols:"4","hide-details":""},{"menu-list":y(()=>[c(w,{title:"192.000 kHz",onClick:d[23]||(d[23]=p=>g.value=192e3)}),c(w,{title:"96.000 kHz",onClick:d[24]||(d[24]=p=>g.value=96e3)}),c(w,{title:"88.200 kHz",onClick:d[25]||(d[25]=p=>g.value=88200)}),c(w,{title:"48.000 kHz",onClick:d[26]||(d[26]=p=>g.value=48e3)}),c(w,{title:"44.100 kHz",onClick:d[27]||(d[27]=p=>g.value=44100)}),c(w,{title:"32.000 kHz",onClick:d[28]||(d[28]=p=>g.value=32e3)}),c(w,{title:"22.050 Hz",onClick:d[29]||(d[29]=p=>g.value=22050)})]),_:1},8,["modelValue","rule"]),c(O,null,{default:y(()=>[c($,{class:"mt-3"}),c(S,{cols:"4"},{default:y(()=>[c(W,{modelValue:Y.value,"onUpdate:modelValue":d[31]||(d[31]=p=>Y.value=p),label:"音の再生","hide-details":"",onClick:_n,density:"compact"},null,8,["modelValue"])]),_:1}),c(S,{cols:"8","align-self":"center"},{default:y(()=>[c(Ge,{style:{height:"16px"},value:Pe.value,max:-30,min:-50,disabled:!Y.value},null,8,["value","disabled"]),c(Ge,{style:{height:"16px"},value:Pe.value,max:-9,min:-30,disabled:!Y.value,fillColor:"orange",strokeColor:"orange"},null,8,["value","disabled"]),c(Ge,{style:{height:"16px"},value:Pe.value,max:0,min:-9,disabled:!Y.value,fillColor:"red",strokeColor:"red"},null,8,["value","disabled"])]),_:1})]),_:1}),c(se,{modelValue:he.value,"onUpdate:modelValue":d[32]||(d[32]=p=>he.value=p),label:"ボリューム",variant:"underlined",density:"compact",unit:"dB",min:-80,max:30,"fraction-digits":2,rule:[A(I).required,A(I).value],cols:"4","hide-details":""},null,8,["modelValue","rule"]),c(O,null,{default:y(()=>[c($,{class:"mb-3"}),c(S,{cols:"6"},{default:y(()=>[c(_,{label:"インパルス長",density:"compact",variant:"underlined",modelValue:f.value,"onUpdate:modelValue":d[33]||(d[33]=p=>f.value=p),items:[256,512,1024,2048,4096,8192,16384,32768],"hide-details":""},null,8,["modelValue"])]),_:1}),c(S,{cols:"6"},{default:y(()=>[c(_,{label:"インパルス応答のグラフ長",density:"compact",variant:"underlined",modelValue:b.value,"onUpdate:modelValue":d[34]||(d[34]=p=>b.value=p),items:Array.from({length:Math.log2(f.value)-2},(p,Rn)=>8<<Rn),"hide-details":""},null,8,["modelValue","items"])]),_:1})]),_:1}),c(se,{modelValue:i.value,"onUpdate:modelValue":d[35]||(d[35]=p=>i.value=p),label:"周波数応答の最小振幅",variant:"underlined",density:"compact",unit:"dB",max:0,min:-150,step:10,rule:[A(I).required,A(I).value],cols:"4","hide-details":""},null,8,["modelValue","rule"])]),_:1}),c(S,{cols:"12",md:"5",class:"text-center"},{default:y(()=>[c(O,null,{default:y(()=>[c(S,{cols:"12"},{default:y(()=>[m("object",{ref_key:"diagram",ref:n,class:"diagram color-responsive",type:"image/svg+xml",data:"/tools/filter/biquad.svg",onLoad:Cn},null,544)]),_:1}),c(S,{cols:"12"},{default:y(()=>[m("div",Os,[c(St,{ref_key:"chart",ref:s,initializer:kn},null,512)])]),_:1}),c(S,{cols:"12"},{default:y(()=>[m("div",zs,[c(St,{ref_key:"impulseChart",ref:a,initializer:Sn},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),c(O,null,{default:y(()=>[c($),c(S,{cols:"6"},{default:y(()=>[d[44]||(d[44]=m("h4",{class:"mb-3"},"フィルタ係数",-1)),c(P,{tag:"p",class:"mb-3"},{default:y(()=>d[37]||(d[37]=[M(" H(z) = \\displaystyle\\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{a_0 + a_1 z^{-1} + a_2 z^{-2}} ")])),_:1}),m("table",js,[m("tbody",null,[m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[38]||(d[38]=[M("b_0 =")])),_:1}),m("td",Fs,R(D.value[0].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[39]||(d[39]=[M("b_1 =")])),_:1}),m("td",Es,R(D.value[1].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[40]||(d[40]=[M("b_2 =")])),_:1}),m("td",Bs,R(D.value[2].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[41]||(d[41]=[M("a_0 =")])),_:1}),m("td",Vs,R(D.value[3].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[42]||(d[42]=[M("a_1 =")])),_:1}),m("td",Ws,R(D.value[4].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[43]||(d[43]=[M("a_2 =")])),_:1}),m("td",Ls,R(D.value[5].toFixed(9)),1)])])])]),_:1}),c(S,{cols:"6"},{default:y(()=>[d[51]||(d[51]=m("h4",{class:"mb-3"},"正規化フィルタ係数",-1)),c(P,{tag:"p",class:"mb-3"},{default:y(()=>d[45]||(d[45]=[M(" H(z) = \\displaystyle\\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}} ")])),_:1}),m("table",Ns,[m("tbody",null,[m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[46]||(d[46]=[M("b_0 =")])),_:1}),m("td",Hs,R(q.value[0].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[47]||(d[47]=[M("b_1 =")])),_:1}),m("td",Ys,R(q.value[1].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[48]||(d[48]=[M("b_2 =")])),_:1}),m("td",$s,R(q.value[2].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[49]||(d[49]=[M("a_1 =")])),_:1}),m("td",Xs,R(q.value[3].toFixed(9)),1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[50]||(d[50]=[M("a_2 =")])),_:1}),m("td",Qs,R(q.value[4].toFixed(9)),1)])])])]),_:1})]),_:1}),c(O,null,{default:y(()=>[c($),c(S,{cols:"12"},{default:y(()=>[d[56]||(d[56]=m("h4",{class:"mb-5"},"インパルス長",-1)),c(O,null,{default:y(()=>[c(S,{cols:"4"},{default:y(()=>[c(_,{label:"インパルス長",density:"compact",variant:"underlined",modelValue:T.value,"onUpdate:modelValue":d[36]||(d[36]=p=>T.value=p),items:A(At)(16,25).map(p=>2**p),"hide-details":"",disabled:r.value,loading:r.value},null,8,["modelValue","items","disabled","loading"])]),_:1}),c(S,{cols:"auto"},{default:y(()=>[c(oe,{variant:"outlined",onClick:Pn,disabled:r.value||T.value===x.value,loading:r.value},{default:y(()=>d[52]||(d[52]=[M("再計算")])),_:1},8,["disabled","loading"])]),_:1}),c(S,{cols:"12"},{default:y(()=>[d[55]||(d[55]=M(" 計算時のインパルス長 ")),c(P,null,{default:y(()=>d[53]||(d[53]=[M("N = ")])),_:1}),M(" "+R(x.value)+"（周波数分解能 ",1),c(P,null,{default:y(()=>d[54]||(d[54]=[M("\\frac{f_c}{N} = ")])),_:1}),M(" "+R((g.value/x.value).toFixed(3))+" [Hz]） ",1)]),_:1})]),_:1})]),_:1}),c(S,{cols:"6"},{default:y(()=>[d[59]||(d[59]=m("h4",{class:"mb-3"},"カットオフ周波数の振幅",-1)),m("table",Us,[m("tbody",null,[m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[57]||(d[57]=[M("f_c =")])),_:1}),m("td",null,R(l.value.toFixed(3))+" [Hz]",1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[58]||(d[58]=[M("A_{f_c} =")])),_:1}),m("td",null,R(Number.isNaN(z.value)?"---":z.value.toFixed(3))+" [dB]",1)])])])]),_:1}),c(S,{cols:"6"},{default:y(()=>[d[64]||(d[64]=m("h4",{class:"mb-3"},"最大と最小振幅",-1)),m("table",Gs,[m("tbody",null,[m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[60]||(d[60]=[M("\\max A =")])),_:1}),m("td",null,R(F.value.toFixed(3))+" [dB]",1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[61]||(d[61]=[M("f_{\\max A} =")])),_:1}),m("td",null,R($e.value.toFixed(3))+" [Hz]",1)]),m("tr",null,[c(P,{tag:"td",class:"mb-2"},{default:y(()=>d[62]||(d[62]=[M("\\min A =")])),_:1}),m("td",null,R(K.value.toFixed(3))+" [dB]",1)]),m("tr",null,[c(P,{tag:"td"},{default:y(()=>d[63]||(d[63]=[M("f_{\\min A} =")])),_:1}),m("td",null,R(Xe.value.toFixed(3))+" [Hz]",1)])])])]),_:1}),c(S,{cols:"6"},{default:y(()=>[d[66]||(d[66]=m("h4",{class:"mb-3"},"インパルス応答の総和",-1)),c(P,null,{default:y(()=>d[65]||(d[65]=[M("\\displaystyle\\sum^{N-1}_{n=0} y[n] =")])),_:1}),M(" "+R(Qe.value.toFixed(6)),1)]),_:1})]),_:1})]),_:1})}}}),Ks=Zn(Js,[["__scopeId","data-v-1dc8fcf6"]]);En("#app",Ks);
