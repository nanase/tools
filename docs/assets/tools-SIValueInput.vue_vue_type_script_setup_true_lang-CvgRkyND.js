import{d as v,a7 as g,U as h,a8 as V,j as b,k as N,n as F,o as P,c as w,u as c,a9 as M}from"./tools-ToolAppBase.vue_vue_type_script_setup_true_lang-BJ6W5dVp.js";var k=Object.defineProperty,$=(n,e,t)=>e in n?k(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,S=(n,e,t)=>$(n,e+"",t);const m={symbol:"",exponent:0},f=[{symbol:"Q",exponent:30},{symbol:"R",exponent:27},{symbol:"Y",exponent:24},{symbol:"Z",exponent:21},{symbol:"E",exponent:18},{symbol:"P",exponent:15},{symbol:"T",exponent:12},{symbol:"G",exponent:9},{symbol:"M",exponent:6},{symbol:"k",exponent:3},{symbol:"h",exponent:2},{symbol:"da",exponent:1},m,{symbol:"d",exponent:-1},{symbol:"c",exponent:-2},{symbol:"m",exponent:-3},{symbol:"μ",exponent:-6},{symbol:"u",exponent:-6},{symbol:"n",exponent:-9},{symbol:"p",exponent:-12},{symbol:"f",exponent:-15},{symbol:"a",exponent:-18},{symbol:"z",exponent:-21},{symbol:"y",exponent:-24},{symbol:"r",exponent:-27},{symbol:"q",exponent:-30}],y=class i{constructor(e,t){this.fraction=e,this.prefix=t}get actualValue(){return this.fraction*10**this.prefix.exponent}toString(){return`${this.fraction}${this.prefix.symbol}`}toSimpleString(e){return`${Number(this.fraction.toFixed(e))}${this.prefix.symbol}`}toFixed(e){return`${this.fraction.toFixed(e)}${this.prefix.symbol}`}static getPrefixSymbols(e){return f.filter(t=>t.exponent%(e?1:3)===0).map(t=>t.symbol)}static test(e){return i.siValuePattern.test(e??"")}static parse(e){const t=i.siValuePattern.exec(e??"");if(t==null)return new i(Number.NaN,m);const o=Number.parseFloat(t[1]),r=f.find(s=>s.symbol===t[2]);return new i(o,r)}static fit(e,t){if(!Number.isFinite(e)&&t.length===0)return new i(e,m);if(e!==0){const o=Math.sign(e);e=Math.abs(e);const r=t.map(s=>{const a=i.getPrefix(s),u=e*10**-a.exponent,l=Math.abs(u-500);return{prefix:a,practicalValue:u,rank:l}}).sort((s,a)=>s.rank-a.rank);return new i(r[0].practicalValue*o,r[0].prefix)}else return new i(0,m)}static fitBy(e,t){const o=i.getPrefix(t);if(!Number.isFinite(e))return new i(e,o);const r=Math.sign(e);e=Math.abs(e);const s=e*10**-o.exponent;return new i(s*r,o)}static getPrefix(e){const t=f.find(o=>o.symbol===e);if(!t)throw new Error(`Prefix symbol '${e}' is not defined.`);return t}static successor(e,t){const o=i.getPrefix(e),r=f.filter(a=>a.exponent>o.exponent&&a.exponent%(t?1:3)===0);if(r.length===0)return e;const s=r.slice(-1)[0];return r.filter(a=>a.exponent===s.exponent)[0].symbol}static predecessor(e,t){const o=i.getPrefix(e),r=f.filter(s=>s.exponent<o.exponent&&s.exponent%(t?1:3)===0);return r.length===0?e:r[0].symbol}};S(y,"siValuePattern",/^([+-]?(?:[0-9]*\.)?[0-9]+)([QRYZEPTGMkmuμnpfazyrq]?)$/);let x=y;const p={required:n=>!!n||"値を入力してください",value:n=>Number.isFinite(x.parse(n).fraction)||"不正な値です",notZero:n=>Number(n)!==0||"値を 0 にはできません",notNegative:n=>{const e=x.parse(n);return Number.isFinite(e.fraction)&&e.fraction>=0||"負値にはできません"}},Z=v({__name:"SIValueInput",props:g({unit:null,prefixSymbols:null,fractionDigits:null,rule:null},{value:{},valueModifiers:{}}),emits:["update:value"],setup(n){const e=h(),t=V(n,"value"),o=b(),r=b();N(()=>t.value,()=>{s()}),F(()=>{s()});function s(){var u;if(typeof t.value<"u"&&Number.isFinite(t.value)&&!((u=r.value)!=null&&u.focused)){const l=x.fit(t.value,n.prefixSymbols??[""]);o.value=`${l.toFixed(n.fractionDigits??3)}`}}function a(u){const l=x.parse(u);Number.isFinite(l.fraction)&&(t.value=l.actualValue)}return(u,l)=>(P(),w(c(M),{"model-value":o.value,"onUpdate:modelValue":[l[0]||(l[0]=d=>o.value=d),a],rules:c(e).readonly?[]:n.rule?n.rule:[c(p).required,c(p).value,c(p).notZero,c(p).notNegative],prefix:n.unit,class:"text-align-right",reverse:"",inputmode:"numeric",ref_key:"field",ref:r},null,8,["model-value","rules","prefix"]))}});export{Z as _,x as l,p as o};
