var P=Object.defineProperty;var F=(n,e,t)=>e in n?P(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var p=(n,e,t)=>F(n,typeof e!="symbol"?e+"":e,t);import{d as v,j as M,u as k,r as m,w as B,z as g,a as b,o as C,c as $,b as y,e as h,q as f,V as q,A as S}from"./tools-AppBase.vue_vue_type_script_setup_true_lang-CtLU3Mb_.js";const u={symbol:"",exponent:0},x=[{symbol:"Q",exponent:30},{symbol:"R",exponent:27},{symbol:"Y",exponent:24},{symbol:"Z",exponent:21},{symbol:"E",exponent:18},{symbol:"P",exponent:15},{symbol:"T",exponent:12},{symbol:"G",exponent:9},{symbol:"M",exponent:6},{symbol:"k",exponent:3},{symbol:"h",exponent:2},{symbol:"da",exponent:1},u,{symbol:"d",exponent:-1},{symbol:"c",exponent:-2},{symbol:"m",exponent:-3},{symbol:"μ",exponent:-6},{symbol:"u",exponent:-6},{symbol:"n",exponent:-9},{symbol:"p",exponent:-12},{symbol:"f",exponent:-15},{symbol:"a",exponent:-18},{symbol:"z",exponent:-21},{symbol:"y",exponent:-24},{symbol:"r",exponent:-27},{symbol:"q",exponent:-30}],r=class r{constructor(e,t){this.fraction=e,this.prefix=t}get actualValue(){return this.fraction*10**this.prefix.exponent}static getPrefixSymbols(e){return x.filter(t=>t.exponent%(e?1:3)===0).map(t=>t.symbol)}static test(e){return r.siValuePattern.test(e??"")}static parse(e){const t=r.siValuePattern.exec(e??"");if(t==null)return new r(Number.NaN,u);const a=Number.parseFloat(t[1]),o=x.find(l=>l.symbol===t[2]);return o?new r(a,o):new r(a,u)}static fit(e,t){if(!Number.isFinite(e)&&t.length===0)return new r(e,u);if(e!==0){const a=t.map(o=>{const l=r.getPrefix(o),i=e*10**-l.exponent,s=Math.abs(i-500);return{prefix:l,practicalValue:i,rank:s}}).sort((o,l)=>o.rank-l.rank);return new r(a[0].practicalValue,a[0].prefix)}else return new r(0,u)}static fitBy(e,t){if(!Number.isFinite(e))return new r(e,u);const a=r.getPrefix(t),o=e*10**-a.exponent;return new r(o,a)}static getPrefix(e){const t=x.find(a=>a.symbol===e);if(!t)throw new Error(`Prefix symbol '${e}' is not defined.`);return t}static successor(e,t){const a=r.getPrefix(e),o=x.filter(i=>i.exponent>a.exponent&&i.exponent%(t?1:3)===0);if(o.length===0)return e;const l=o.slice(-1)[0];return o.filter(i=>i.exponent===l.exponent)[0].symbol}static predecessor(e,t){const a=r.getPrefix(e),o=x.filter(l=>l.exponent<a.exponent&&l.exponent%(t?1:3)===0);return o.length===0?e:o[0].symbol}};p(r,"siValuePattern",/^([+-]?(?:[0-9]*\.)?[0-9]+)([QRYZEPTGMkmuμnpfazyrq]?)$/);let c=r;const d={required:n=>!!n||"値を入力してください",value:n=>Number.isFinite(c.parse(n).fraction)||"不正な値です",notZero:n=>Number(n)!==0||"値を 0 にはできません",notNegative:n=>{const e=c.parse(n);return Number.isFinite(e.fraction)&&e.fraction>=0||"負値にはできません"}},Z=v({__name:"SIValueInput",props:M({label:null,variant:null,density:null,placeholder:null,unit:null,prefixSymbols:null,readonly:{type:Boolean},disabled:{type:Boolean},fractionDigits:null,rule:null,hideDetails:{type:[Boolean,String]}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(n){const e=k(n,"value"),t=m(),a=m();B(()=>e.value,()=>{o()}),g(()=>{o()});function o(){var i;if(typeof e.value<"u"&&Number.isFinite(e.value)&&!((i=a.value)!=null&&i.focused)){const s=c.fit(e.value,n.prefixSymbols??[""]);t.value=`${s.fraction.toFixed(n.fractionDigits??3)}${s.prefix.symbol}`}}function l(i){const s=c.parse(i);Number.isFinite(s.fraction)&&(e.value=s.actualValue)}return(i,s)=>{const w=b("v-col"),V=b("v-row");return C(),$(V,{"no-gutters":""},{default:y(()=>[h(w,null,{default:y(()=>[h(f(q),{"model-value":t.value,"onUpdate:modelValue":[s[0]||(s[0]=N=>t.value=N),l],label:n.label,variant:n.variant,density:n.density,placeholder:n.placeholder,rules:n.readonly?[]:n.rule?n.rule:[f(d).required,f(d).value,f(d).notZero,f(d).notNegative],readonly:n.readonly,disabled:n.disabled,prefix:n.unit,class:"text-align-right",reverse:"",inputmode:"numeric",ref_key:"field",ref:a,"hide-details":n.hideDetails},null,8,["model-value","label","variant","density","placeholder","rules","readonly","disabled","prefix","hide-details"])]),_:1})]),_:1})}}}),z=v({__name:"MathJax",setup(n){return g(()=>{window.MathJax.typeset()}),(e,t)=>S(e.$slots,"default")}});export{d as R,Z as _,z as a};
